---
title: frp 初探
urlname: frp-server
date: 2021-06-15 18:38:16
tags:
- 配置
- 工具
categories:
- 技术
top:
---

最近由于个人原因离校一段时间，但机房电脑数据太多懒得处理。遂花了半小时左右搭建了 frp 服务器。

<!-- more -->

## 准备工作

frp 就是 fast reverse proxy。（目前笔者用到的）功能就是借助一台有公网 ip 的服务器作为中转，把内外网的流量连接起来。

[Github - fatedier/frp](https://github.com/fatedier/frp)

先买了台小鸡来充当公网主机（服务端）。

确保机房的设备，也就是内网主机（客户端）网络畅通。

测试了**内网主机能够直连公网主机**。

<!-- 这点在特殊的网络环境下尤为重要。 -->

## 服务端搭建

先自行下载解压 frp。

```bash
mkdir -p /etc/frp/
cd /etc/frp/
wget "https://github.com/fatedier/frp/releases/download/vx.y.z/frp_x.y.z_linux_amd64.tar.gz"
tar xzvf frp_x.y.z_linux_amd64.tar.gz
mv frp_x.y.z_linux_amd64/* .
```

服务器端使用的是可执行文件是`frps`，配置文件是`frps.ini`。

最简单的配置就是这样。

```ini
# frps.ini
[common]
bind_port = 7000
```

可以参考`frps_full.ini`，内附有注释。

目前我自己写的配置如下：

```ini
[common]
bind_port = 11450
token = c9a4a645-dd52-44b6-9c63-551ef4412074
authentication_timeout = 5000
dashboard_port = 11451
dashboard_user = admin
dashboard_pwd = c9a4a645-dd52-44b6-9c63-551ef4412074
```

`bind_port` 即用客户端连接到服务端的端口，需要保证其被服务端 firewall 放行。

`dashboard` 相关的几条，开启了一个 `http://[server_addr]:11451` 的 dashboard，可以查看客户端的连接状态。

### 开机启动

~~作为把裤子都卖给 systemd 的壬，~~本人用 systemd 来启动 frps 服务。

v0.37.0 压缩包下附带一个 `./systemd/` 文件夹，内附有 `frps.service`。

但是实际上不太能直接用，得自己改改。

```bash
vim ./systemd/frps.service
cp ./systemd/frps.service /etc/systemd/system/
killall frps
systemctl enable frps.service
```

## 客户端搭建

