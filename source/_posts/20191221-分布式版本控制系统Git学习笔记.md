---
title: 分布式版本控制系统Git学习笔记
date: 2019-12-21 16:25:14
tags:
- Git
categories: 技术
top:
urlname: 分布式版本控制系统Git学习笔记
---

Git 是目前世界上最先进的分布式版本控制系统。

<!-- more -->

# 安装

Windows 下直接[官网](https://git-scm.com/)下，Linux 下可以直接 `sudo apt-get install git` 。

使用下面的命令来设置本地的账户名字与邮箱地址。

```sql
git config --global user.name "Your Name"
git config --global user.email "email@example.com"
```

# 创建版本库

版本库，就是仓库，英文即为 repository 。

选择一个根目录。

<span style="color:rgb(231,0,0)">如果你使用 Windows 系统，为了避免遇到各种莫名其妙的问题，请确保目录名（包括父目录）不包含中文。</span>

第二步，通过`git init`命令把这个目录变成 Git 可以管理的仓库。

然后根目录下就会多出一个`.git`的隐藏目录，如果你没有看到`.git`目录，用`ls -ah`命令就可以看见。

# 把文件添加到版本库

>首先这里再明确一下，所有的版本控制系统，其实只能跟踪文本文件的改动，比如 TXT 文件，网页，所有的程序代码等等， Git 也不例外。版本控制系统可以告诉你每次的改动，比如在第 5 行加了一个单词 “Linux” ，在第 8 行删了一个单词 “Windows” 。而图片、视频这些二进制文件，虽然也能由版本控制系统管理，但没法跟踪文件的变化，只能把二进制文件每次改动串起来，也就是只知道图片从 100KB 改成了 120KB ，但到底改了啥，版本控制系统不知道，也没法知道。
>不幸的是， Microsoft 的 Word 格式是二进制格式，因此，版本控制系统是没法跟踪 Word 文件的改动的，前面我们举的例子只是为了演示，如果要真正使用版本控制系统，就要以纯文本方式编写文件。
>因为文本是有编码的，比如中文有常用的 GBK 编码，日文有 Shift_JIS 编码，如果没有历史遗留问题，**强烈建议使用标准的 UTF-8 编码**，所有语言使用同一种编码，既没有冲突，又被所有平台所支持。
>
><span style="color:rgb(231,0,0)">使用 Windows 的童鞋要特别注意：</span>
>千万不要使用 Windows 自带的记事本编辑任何文本文件。原因是 Microsoft 开发记事本的团队使用了一个非常弱智的行为来保存 UTF-8 编码的文件，他们自作聪明地在每个文件开头添加了 `0xefbbbf`（十六进制）的字符，你会遇到很多不可思议的问题，比如，网页第一行可能会显示一个 “?” ，明明正确的程序一编译就报语法错误，等等。这些都是由记事本的弱智行为带来的。

言归正传，把一个文件添加到 Git 仓库需要两步。

1. 把文件添加或更新到仓库：

```sql
git add <file>
git add <file1> <file2> ...
```

执行上面的命令，没有任何显示，这就对了，Unix 的哲学是“没有消息就是好消息”，说明添加或修改成功。

2. 把文件提交(commit)到仓库：

```sql
git commit -m "massage"
```

`-m` 后面输入的字符串是对本次提交的说明，可以输入任意内容，当然最好是有意义的。

# 掌握工作区状态

`git status`命令可以让我们时刻掌握仓库当前的状态。

就比如说原博客给的一个例子：

```sql
$ git status
On branch master
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

	modified:   readme.txt

no changes added to commit (use "git add" and/or "git commit -a")
```

上面的命令输出告诉我们，`readme.txt`被修改过了，但还没有准备提交的修改。

那假如我想要知道`readme.txt`哪里被修改了怎么办？这时就需要使用`git diff`命令来查看。

例如原博客给的一个例子：

```sql
$ git diff readme.txt 
diff --git a/readme.txt b/readme.txt
index 46d49bf..9247db6 100644
--- a/readme.txt
+++ b/readme.txt
@@ -1,2 +1,2 @@
-Git is a version control system.
+Git is a distributed version control system.
 Git is free software.
```

`git diff`顾名思义就是查看 difference ，显示的格式正是 Unix 通用的 diff 格式。可以从上面的命令输出看到，我们在第一行添加了一个 distributed 单词。

也可以`git diff <file>`来查看单个文件的修改。

# 查看历史提交记录

`git log`指令可以显示从最近到最远的提交日志。

会显示每次提交的 commit id, Author, Date 与我们在提交时写的`<message>`。

如果嫌输出信息太多，看得眼花缭乱的，可以使用`git log --pretty=oneline`，这样只会显示 commit id 和`<message>`。

使用`git reflog`可以显示每一次命令，包括提交、回退版本等。

# 版本回退


首先， Git 必须知道当前版本是哪个版本，在 Git 中，用 `HEAD` 表示当前版本，也就是最新的提交，上一个版本就是 `HEAD^` ，上上一个版本就是 `HEAD^^` ，当然往上 100 个版本写 100 个 `^` 比较容易数不过来，所以写成 `HEAD~100` 。

就比如说`git reset --hard HEAD^`就回退到上一个版本。

所以说回退版本的命令就是：

```sql
git reset --hard <commit_id>
```

这样就回退到你需要的版本了。

但是如果要恢复新版本怎么办？

通过`git reflog`查看新版本对应的 commit id ，也使用上述指令即可。

Git 的版本回退速度非常快，因为 Git 在内部有个指向当前版本的`HEAD`指针，当你回退版本的时候， Git 仅仅是把`HEAD`修改，然后顺便把工作区的文件更新。所以不仅可以回到历史版本也可以返回新版本。

# 工作区与暂存区的概念

[直接贴廖雪峰老师的博客了。](https://www.liaoxuefeng.com/wiki/896043488029600/897271968352576)

# 参考文献

[Pro Git](https://git-scm.com/book/zh/v2)

[廖雪峰的Git教程](https://www.liaoxuefeng.com/wiki/896043488029600)